<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta charset="utf-8" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="no"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Third Coast International Audio Festival"/>
    <link rel="shortcut icon" href="/images/favicon.ico"/>

    <link rel="stylesheet" type="text/css" href="/css/tciaf.css" />
    
    <title>[$title]</title>
    
    <script type="text/javascript">
      // <![CDATA[
      window.bloc = (function(d,w,c,q,t) {
        return { 
          tag: function (src, async) {var s = d.createElement('script');s.type = 'text/javascript';s.src = src;s.async = async;return s;},
          embed: function() {for (var i=0; i < arguments.length; i++) {var s = this.tag(arguments[i], false);s.onload = this.load; q.push(s);} return this;},
          track: function (src) { for (var i=0; i < arguments.length; i++) {t.push(this.tag(arguments[i], true));} return this;},
          load: function(){ if (q.length > 0) {d.body.appendChild(q.shift()); } else { w.bloc.execute();}},
          execute: function() {c.forEach(function (f) { f.call();}); c=[]; while(t.length > 0) d.body.appendChild(t.shift());},
          prepare: function(f) {if (typeof f === 'function') c.unshift(f);}
      };}(document, window, [], [], []));
      
      bloc.embed('/js/bloc.js');
      // ]]>
    </script>
  </head>
  <body class="unloaded">
    <header class="content container">
      <!-- replace helper -->
      <h1>Third Coast International Audio Festival</h1>
    </header>

    <div class="content container">
      
      <!-- replace content nextSibling -->
      <section>
        <div id="test">
          <p class="pretty">Welcome to the Third Coast International Audio Festival Homepage</p>
        </div>
        <input type="range" name="space" min="1" max="100" value="1" id="space" oninput="update(document.getElementById('widget'), this.value);"/>
        <script type="text/javascript">
        // <![CDATA[
          bloc.prepare(function () {
            var myRequest = new XMLHttpRequest();
                myRequest.open("GET", "/.xml");
                myRequest.setRequestHeader("X-Requested-With", "XMLHttpRequest");
                myRequest.send();
              
                myRequest.onreadystatechange = function () {
                  if (myRequest.readyState === 4) {
                    if (myRequest.status === 200) {
                      // console.log(myRequest.responseXML);
                    } else {
                      console.log('boop');
                    }
                  }
                };
              
            var s = new SVG(document.getElementById('test'), {height:500,width:500, viewBox:'0 0 100 100'});
            
            
            s.createElement('path', {
              d: getPath(10),
              //rx ry x-axis-rotation large-arc-flag sweep-flag x y)+
              stroke:'#000',
              'stroke-width':2,
              fill: 'none',
              id: 'widget'
            });
            
            
          });
          
          function update(elem, divs) {
            elem.setAttribute('d', getPath(parseInt(divs, 10)));
          }
          
          function getPath(divs) {
            
            var complete = parseFloat((2 * Math.PI).toFixed(3));
            var third = parseFloat((((100/3)/100) * complete).toFixed(3));
            var space = ((100/divs)/100);
            
            var dims = {
              length: 100,
              slug: 'M{sx},{sy}A{radius},{radius},0,0,1,{x},{y}'
            };
            var radian = third;
          
            dims.radius = dims.length / 4;
            dims.center = dims.length / 2;
          
            dims.sx = dims.center + Math.cos(space) * dims.radius;
            dims.sy = dims.center + dims.radius * Math.sin(space);
          
            var path = '';
            for (var radian = third; radian <= complete; radian += third) {
            
              dims.x = dims.center + (Math.cos(radian - space) * dims.radius);
              dims.y = dims.center + (Math.sin(radian - space) * dims.radius);
            
              path += dims.slug.format(dims);
            
              dims.sx = dims.center + (Math.cos(radian + space) * dims.radius);
              dims.sy = dims.center + (Math.sin(radian + space) * dims.radius);
            }
            return path;
          }
        // ]]>
        </script>
        <style type="text/css">.pretty {font-size:4em;}svg {border:1px solid #000;}</style>
      </section>
    </div>
    
    <!-- insert views/pages/footer.html -->
    
    <script type="text/javascript">
      window.bloc.load();
    </script>
  </body>
</html>
