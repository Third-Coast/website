<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta charset="utf-8" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="no"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Third Coast International Audio Festival"/>
    <link rel="shortcut icon" href="/images/favicon.ico"/>

    <link rel="stylesheet" type="text/css" href="/css/tciaf.css" />
    
    <title>[$title]</title>
    
    <script type="text/javascript">
      // <![CDATA[
      window.bloc = (function(d,w,c,q,t) {
        return { 
          tag: function (src, async) {var s = d.createElement('script');s.type = 'text/javascript';s.src = src;s.async = async;return s;},
          embed: function() {for (var i=0; i < arguments.length; i++) {var s = this.tag(arguments[i], false);s.onload = this.load; q.push(s);} return this;},
          track: function (src) { for (var i=0; i < arguments.length; i++) {t.push(this.tag(arguments[i], true));} return this;},
          load: function(){ if (q.length > 0) {d.body.appendChild(q.shift()); } else { w.bloc.execute();}},
          execute: function() {c.forEach(function (f) { f.call();}); c=[]; while(t.length > 0) d.body.appendChild(t.shift());},
          prepare: function(f) {if (typeof f === 'function') c.unshift(f);}
      };}(document, window, [], [], []));
      bloc.embed('/js/bloc.js');
      // ]]>
    </script>
  </head>
  <body class="unloaded">
    <header class="content container">
      <!-- replace helper -->
      <h1>Third Coast International Audio Festival</h1>
    </header>

    <div class="content container">
      
      <!-- replace content nextSibling -->
      <section>
        <style type="text/css" media="screen">
          /* <![CDATA[ */
          
          #Library {
            width:65%;
          }
          #Viewer {
            width:35%;
          }
          #Library span {
            font-size:0.25em;
            display:block;
            float:left;
            width:2em;
            height:2em;
            padding:0.5em 0;
            box-sizing:border-box;
            text-align:center;
            margin:0;
            border:0.125em solid #fff;
            color:#fff;
            cursor:pointer;
            transition:background-color 0.5s;
          }
          #Library span.color {
            background-color:#333;
          }
          #Library span:hover {
            background-color:#5b9b98;
            border-color:#5B9B98;
          }
          #titles em span {
            color:#ccc;
            padding:0 0.25em;
            
          }
          section ul.inline {
            margin:2em 0;
          }
          
          section ul.inline li {
            border:1px solid #000;
            padding:1em;
          }
          /* ]]> */
        </style>
        <ul class="inline clear">
          <li>Sort by Featured</li>
          <li>Sort by Created</li>
          <li>Filter Short Docs</li>
          <li>Filter Re:Sound</li>
          <li>Sort by Alphabetical</li>
          <li>Show TCF Winners</li>
          <li>Show Conference Audio</li>
          <li>Rando</li>
        </ul>
        <div class="container">
          <div id="Viewer" class="group left">
            <div id="titles">Library</div>
          
          </div>
          <div id="Library" class="group left" data-tokens="[$tokens]">
          </div>
        </div>
        <script type="text/javascript">
        // <![CDATA[

        bloc.prepare(function () {
          var library = document.getElementById('Library');
          var titles = document.getElementById('titles');
          var http   = new XMLHttpRequest();
          var timer = 0;

              
          http.addEventListener('load', function (evt) {
            if (evt.target.status >= 400) return
            var vertex = evt.target.responseXML.documentElement;
            titles.innerHTML = '<h2>' + vertex.getAttribute('title') + '</h2><p><em>' + vertex.querySelector('abstract').innerHTML.replace(/(Â¶)/g, '<span>$1</span>') + '</em></p>' + titles.innerHTML;
          }, false);
          

              
          library.addEventListener('mouseover', function (evt) {
            // console.log(request);
            if (evt.target.nodeName == 'SPAN') {
              clearTimeout(timer);
              http.open('GET', '/explore/feature/' + evt.target.id + '.xml');
              timer = setTimeout(function () {
                http.send();
              }, 200);
            }
          }, false);

          library.dataset.tokens.split(' ').forEach(function (token, idx) {
            var s = library.appendChild(document.createElement('span'));
                s.id = token;
                s.textContent = idx;
            
            setTimeout(function () {
              s.className = 'color';
            }, Math.random() * 1000);
          });
          
        });
        // ]]>
        </script>
        
      </section>
    </div>
    
    <!-- insert views/pages/footer.html -->
    
    <script type="text/javascript">
      window.bloc.load();
    </script>
  </body>
</html>
