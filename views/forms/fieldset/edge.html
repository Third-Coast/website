

<fieldset class="responsive edges container">
  <style type="text/css" media="screen">
    /* <![CDATA[ */
    fieldset.edges dl {
      clear:both;
    }
    fieldset.edges dl dt {
      width:20%;
      text-transform:uppercase;
      text-align:right;
      color:#5B9B98;
      font-size:1.125em;
      font-weight:400;
      padding:1em 2.5%;
    }
    
    fieldset.edges dl dd {
      width:80%;
      float:right;
      padding:0 0 0.5em;
      border-bottom:1px solid #f8f8f8;
      position:relative;
    }
    
    fieldset.edges dl dd a {
      margin:0.75em 0;
      border:none;
      font-weight:600;
      text-transform:capitalize;
      padding:0.25em 0.5em;
    }
    
    a.sort {
      display:none;
    }
    fieldset.edges dl dd div + div + a.sort {
      position:absolute;
      display:block;
      left:-8em;
      top:5em;
      display:block !important;
    }
    
    fieldset.edges dl dd:hover a.sort {
      visibility:visible;
    }
    
    fieldset.edges div.container h2 {
    }
    dd.sorting div.edge {
      background-color:#f8f8f8;
      border-left-width:2em;
      margin-bottom:1px;
      cursor:move;
    }
    dt.closed ~ dd {
      display:none;
    }
    /* ]]> */
  </style>
  
  
  <legend class="caps-lock">References</legend>
  
  <div class="container" style="margin-bottom:2em;">
    <h2>[About this $item:_model]</h2>
    
    <!-- iterate item:structure:has -->
    <dl>
      <dt class="group left collapse">[$name(s)]</dt>

      <!-- iterate items -->
      <dd class="group container">
        <a href="[/manage/edge/$name/$type]" class="showmodal button">[+ Add $name]</a>

        <!-- iterate items -->
        <!-- insert views/forms/partials/edge.html -->
        
        <a href="#" class="sort button">Sort List</a>
  
      </dd>
    </dl>
  </div>

  <hr />
  
  <div class="container">
  
    <h2>[This $item:_model is:]</h2>
  
    <!-- iterate item:structure:acts -->
    <dl>
      <dt class="group left collapse">[$name]</dt>

      <!-- iterate items -->
      <dd class="group container">
        <a href="[/manage/edge/$name/$type]" class="showmodal button">[+ Add to $name]</a>
        
        
        <!-- iterate items -->
        <!-- insert views/forms/partials/edge.html -->
        
        <a href="#" class="sort button">Sort List</a>
      </dd>
    </dl>
    
  </div>
  
  
  
  
  <script type="text/javascript">
    // <![CDATA[
      bloc.prepare(function () {
        document.querySelector('fieldset.edges').addEventListener('click', function (evt) {
          if (evt.srcElement.nodeName == 'DT') {
            evt.target.classList.toggle('closed');
          }
        }, false);
        
        document.querySelectorAll('a.sort').forEach(function (button) {
          button.addEventListener('click', function (evt) {
            evt.preventDefault();
            var list = this.parentNode;
            list.classList.add('sorting');
            list.removeChild(this);
            sortable(list, 'div');
            
          }, false);
        });
        document.querySelectorAll('a.showmodal.button').forEach(function (button) {
          button.addEventListener('click', function (evt) {
            evt.preventDefault();
            
            var button = this;
            
            new Modal.Form(
              this.href + '.xml',
              {},
              function (response) {
              var elem = response.querySelector("div.edge");
              button.parentNode.appendChild(elem);
              
              setTimeout(function () {
                elem.classList.add('highlight');
              }, 10);
              
              
              
              
              setTimeout(function () {
                elem.classList.remove('highlight');
              }, 1000);
              
              // close modal
              this.modal.close(function (arg) {
                this.backdrop.parentNode.removeChild(this.backdrop);
                // destroy the object if we need more closure;
              });
            },
            function (form) {
              form.querySelector('input').focus();
            });
            
            
          });
        });
                
        
      });
    // ]]>
  </script>
</fieldset>