<form method="POST" action="/manage/edge" class="editor search">
  
  
  
  <fieldset class="edge" style="background-color:transparent;border:none;margin:1em 0;">
    <legend>[Search for $model to connect]</legend>
    
    <input id="FILTER" data-path="search/group" data-topic="[$model]" data-area="manage/edit" type="text" name="search" placeholder="[search $model]" class="text" autocomplete="off" style="padding:0.5em" onfocus="setupEdgeFinder(this);"/>
    <script type="text/javascript" async="true">
      // <![CDATA[
        function setupEdgeFinder(input) {

            var search = new Search(null, input);
            
            search.subscribers.select.push(function (dataset) {
              var input = this.input;
              var form = this.input.form;
            
              if (dataset.id) {
                form.id.value = dataset.id
                
                var event = document.createEvent("HTMLEvents");
                
                event.initEvent("submit", false, false);
                form.dispatchEvent(event);  
              } else {
                var form = new Modal.Form('/manage/create/'+ dataset.topic + '.xml', {title: input.value}, function (form) {
                  input.value = form.querySelector('input[name*=title]').value;
                  input.dataset.id = form.querySelector('input[name*=id]').value;

                  search.select();
                  this.modal.close();
                });
              }
            });

        }
        
        
      // ]]>
    </script>
        
    <input type="hidden" name="model" value="[$model]" />
    <input type="hidden" name="title" value="[$vertex:@title]" />
    <input type="hidden" name="keyword" value="[$type]" />
    <input type="hidden" name="id" value="" />
    
    
  </fieldset>

</form>